app.controller("WorkoutCtrl",["$rootScope","$scope","$routeParams","$firebase","Group","Exercise","Workout","FBURL","$timeout","$location",function(e,t,n,r,i,s,o,u,a,f){e.userID||f.path("/");e.loading=0;var l=new Date;i.setRefs();s.setRefs();o.setRefs();i.find(n.groupId).$bind(t,"group");a(function(){o.getFirstWorkout().$bind(t,"firstWorkout").then(function(){t.firstWorkout===null&&(t.firstWorkout=!0)})},500);s.dataRef(n.groupId).once("value",function(e){t.exerciseCount=e.numChildren();console.log(t.exerciseCount)});t.today=l.getMonth()+1+"/"+l.getDate()+"/"+l.getFullYear();t.allExercises=s.all(n.groupId);t.exercisesCompleted=0;t.success=function(e){o.setLastRecorded(e,t.today);t.exercisesCompleted++;o.setLastResult(e,"success");o.getWeight(e).once("value",function(t){weight=t.val();a(function(){o.setWeight(e,weight+5)},500);o.setFailures(e,0)})};var c=function(e,t,n,r){var i=0;if(n<r)t=0;else if(n===r&&t>=2){t=0;i=-5}o.setWeight(e,n+i);o.setMaxWeight(e,n+i);o.setFailures(e,t)};t.failed=function(e){var n,r,i;o.setLastRecorded(e,t.today);t.exercisesCompleted++;o.setLastResult(e,"failure");o.getFailures(e).once("value",function(e){n=e.val()+1});o.getWeight(e).once("value",function(e){r=e.val()});o.getMaxWeight(e).once("value",function(e){i=e.val()});a(function(){c(e,n,r,i)},500)};t.getLastRecorded=function(e){e.lastRecorded===t.today&&t.exercisesCompleted++};t.modalClick=function(){t.firstWorkout=!1}}]);